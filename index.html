<html>
    <head>
    <title>SSB-Msg-Schemas - Documentation - SSBC</title>
    <link rel="stylesheet" href="/normalize.css">
    <link rel="stylesheet" href="/styles.css">
    <link rel="stylesheet" href="/atelier-forest-light.css">
    <script src="/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
  </head>
    <body>
      <div id="topnav">
    <div id="topnav-inner">
      <a class="topnav-item " href="/" title="Home">
      Home<br><small>SSBC</small>
    </a>
      <a class="topnav-item " href="/patchwork" title="Patchwork">
      Patchwork<br><small>Social Messaging App</small>
    </a>
      <a class="topnav-item " href="/scuttlebot" title="Scuttlebot">
      Scuttlebot<br><small>P2P Log Store</small>
    </a>
      <a class="topnav-item selected" href="/docs" title="Documentation">
      Documentation<br><small>APIs, Articles</small>
    </a>
    </div>
  </div>
      <div id="layout">
        <div id="leftnav">
      <div class="leftnav-item">Key Concepts</div>
      <div class="leftnav-subitems">
        <div class="leftnav-item ">
      <a href="/secure-scuttlebutt" title="Secure Scuttlebutt: a global database protocol">Secure Scuttlebutt: a global database protocol</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/ssb/linking.html" title="Content-Hash Linking">Content-Hash Linking</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/ssb/secret-handshake.html" title="Secret Handshake: a secure channel protocol">Secret Handshake: a secure channel protocol</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/ssb/end-to-end-encryption.html" title="Private Box: metadata-free encryption">Private Box: metadata-free encryption</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/ssb/faq.html" title="Frequently Asked Questions">Frequently Asked Questions</a>
    </div>
      </div>
      <div class="leftnav-item">API Documentation</div>
      <div class="leftnav-subitems">
        <div class="leftnav-item ">
      <a href="/scuttlebot/api.html" title="scuttlebot">scuttlebot</a>
    </div>
        <div class="leftnav-indent">
          <div class="leftnav-item ">
      <a href="/scuttlebot/plugins/blobs.html" title="blobs">blobs</a>
    </div>
          <div class="leftnav-item ">
      <a href="/scuttlebot/plugins/block.html" title="block">block</a>
    </div>
          <div class="leftnav-item ">
      <a href="/scuttlebot/plugins/friends.html" title="friends">friends</a>
    </div>
          <div class="leftnav-item ">
      <a href="/scuttlebot/plugins/gossip.html" title="gossip">gossip</a>
    </div>
          <div class="leftnav-item ">
      <a href="/scuttlebot/plugins/invite.html" title="invite">invite</a>
    </div>
          <div class="leftnav-item ">
      <a href="/scuttlebot/plugins/private.html" title="private">private</a>
    </div>
          <div class="leftnav-item ">
      <a href="/scuttlebot/plugins/replicate.html" title="replicate">replicate</a>
    </div>
        </div>
        <div class="leftnav-item ">
      <a href="/ssb-client" title="ssb-client">ssb-client</a>
    </div>
        <div class="leftnav-item ">
      <a href="/ssb-feed" title="ssb-feed">ssb-feed</a>
    </div>
        <div class="leftnav-item ">
      <a href="/ssb-keys" title="ssb-keys">ssb-keys</a>
    </div>
        <div class="leftnav-item ">
      <a href="/ssb-msgs" title="ssb-msgs">ssb-msgs</a>
    </div>
        <div class="leftnav-item selected">
      <a href="/ssb-msg-schemas" title="ssb-msg-schemas">ssb-msg-schemas</a>
    </div>
        <div class="leftnav-item ">
      <a href="/ssb-ref" title="ssb-ref">ssb-ref</a>
    </div>
        <div class="leftnav-item ">
      <a href="/ssb-markdown" title="ssb-markdown">ssb-markdown</a>
    </div>
        <div class="leftnav-item ">
      <a href="/patchwork-threads" title="patchwork-threads">patchwork-threads</a>
    </div>
        <div class="leftnav-item ">
      <a href="/ssb-config" title="ssb-config">ssb-config</a>
    </div>
        <div class="leftnav-item ">
      <a href="/secret-stack" title="secret-stack">secret-stack</a>
    </div>
        <div class="leftnav-item ">
      <a href="/muxrpc" title="muxrpc">muxrpc</a>
    </div>
        <div class="leftnav-item ">
      <a href="/muxrpcli" title="muxrpcli">muxrpcli</a>
    </div>
        <div class="leftnav-item ">
      <a href="/mdmanifest" title="mdmanifest">mdmanifest</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/api/pull-stream.html" title="pull-stream">pull-stream</a>
    </div>
      </div>
      <div class="leftnav-item">Articles</div>
      <div class="leftnav-subitems">
        <div class="leftnav-item ">
      <a href="/docs/articles/design-challenge-avoid-centralization-and-singletons.html" title="Design Challenge: Avoiding Centralization and Singletons">Design Challenge: Avoiding Centralization and Singletons</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/articles/design-challenge-sybil-attack.html" title="Design Challenge: Sybil Attacks">Design Challenge: Sybil Attacks</a>
    </div>
        <div class="leftnav-item ">
      <a href="/docs/articles/using-trust-in-open-networks.html" title="Using Trust in Open Networks">Using Trust in Open Networks</a>
    </div>
      </div>
    </div>
        <div id="content">
          <h1 id="ssb-message-schemas">SSB Message Schemas</h1>
<p>Functions to create common SSB messages.</p>
<pre><code class="lang-js">{ type: &#39;post&#39;, text: String, channel: String, root: MsgLink, branch: MsgLink, recps: FeedLinks, mentions: Links }
{ type: &#39;about&#39;, about: Link, name: String, image: BlobLink }
{ type: &#39;contact&#39;, contact: FeedLink, following: Bool, blocking: Bool }
{ type: &#39;vote&#39;, vote: { link: Ref, value: -1|0|1, reason: String } }
{ type: &#39;pub&#39;, pub: { link: FeedRef, host: String, port: Number } }
</code></pre>
<pre><code class="lang-js">var schemas = require(&#39;ssb-msg-schemas&#39;)

schemas.post(text, root (optional), branch (optional), mentions (optional), recps (optional), channel (optional))
// =&gt; { type: &#39;post&#39;, text: text, channel: channel, root: root, branch: branch, mentions: mentions, recps: recps }
schemas.name(id, name)
// =&gt; { type: &#39;about&#39;, about: id, name: name }
schemas.image(id, imgLink)
// =&gt; { type: &#39;about&#39;, about: id, image: imgLink }
schemas.follow(userId)
// =&gt; { type: &#39;contact&#39;, contact: userId, following: true, blocking: false }
schemas.unfollow(userId)
// =&gt; { type: &#39;contact&#39;, contact: userId, following: false }
schemas.block(userId)
// =&gt; { type: &#39;contact&#39;, contact: userId, following: false, blocking: true }
schemas.unblock(userId)
// =&gt; { type: &#39;contact&#39;, contact: userId, blocking: false }
schemas.vote(id, vote)
// =&gt; { type: &#39;vote&#39;, vote: { link: id, value: vote } }
schemas.vote(id, vote, reason)
// =&gt; { type: &#39;vote&#39;, vote: { link: id, value: vote, reason: reason } }
schemas.pub(id, host, port)
// =&gt; { type: &#39;pub&#39;, pub: { link: id, host: host, port: port } }
</code></pre>
<h2 id="notes">Notes</h2>
<h3 id="type-post">type: post</h3>
<pre><code class="lang-js">{ type: &#39;post&#39;, text: String, channel: String, root: MsgLink, branch: MsgLink, recps: FeedLinks, mentions: Links }
</code></pre>
<ul>
<li><code>channel</code> is optionally used to filter posts into groups, similar to subreddits or chat channels.</li>
<li><code>root</code> and <code>branch</code> are for replies.<ul>
<li><code>root</code> should point to the topmost message in the thread.</li>
<li><code>branch</code> should point to the message in the thread which is being replied to.</li>
<li>In the first reply of a thread, <code>root === branch</code>, and both should be included.</li>
<li><code>root</code> and <code>branch</code> should only point to <code>type: post</code> messages. If the post is about another message-type, use <code>mentions</code>.</li>
</ul>
</li>
<li><code>mentions</code> is a generic reference to other feeds, entities, or blobs.<ul>
<li>It is used by user mentions (you typed &quot;@bob&quot;, so bob&#39;s link goes in <code>mentions</code>).</li>
<li>It is used by file-attachments (you attached a file, the reference goes in <code>mentions</code>).</li>
<li>It is used by message-mentions (to reference non-post messages).</li>
</ul>
</li>
<li><code>recps</code> is a list of user-links specifying who the message is for.<ul>
<li>This is typically used for encrypted messages, to specify who the message was encrypted for.</li>
</ul>
</li>
</ul>
<h3 id="type-about">type: about</h3>
<pre><code class="lang-js">{ type: &#39;about&#39;, about: Link, name: String, image: BlobLink }
</code></pre>
<ul>
<li>You should only include 1 votable piece of information at a time in an about message.<ul>
<li>Of the attributes specified here, <code>name</code> and <code>image</code> are votable.</li>
<li>Therefore, <code>name</code> and <code>image</code> should not appear in the same message.</li>
<li>Reason: vote messages cant differentiate on content within a message. If <code>name</code> and <code>image</code> are grouped together, a vote on the message is a vote on both pieces of information.</li>
</ul>
</li>
<li>Typically, <code>type: about</code> is for users, but it can also be used on msgs and blobs.</li>
</ul>

        </div>
      </div>
    </body>
  </html>